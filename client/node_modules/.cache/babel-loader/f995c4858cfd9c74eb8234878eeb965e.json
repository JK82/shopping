{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst errors_1 = require(\"./errors\");\n\nconst utils_1 = require(\"./utils\");\n\nclass IsomorphicClerk {\n  constructor(frontendApi) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let Clerk = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    this.clerkjs = null;\n    this.preopenSignIn = null;\n    this.preopenSignUp = null;\n    this.premountSignInNodes = new Map();\n    this.premountSignUpNodes = new Map();\n    this.premountUserProfileNodes = new Map();\n    this.premountUserButtonNodes = new Map();\n    this.premountMethodCalls = new Map();\n    this._loaded = false;\n    this.ssrData = null;\n\n    this.hydrateClerkJS = async clerkjs => {\n      if (!clerkjs) {\n        throw new Error('Failed to hydrate latest Clerk JS');\n      }\n\n      this.clerkjs = clerkjs;\n      this.premountMethodCalls.forEach(cb => cb());\n\n      if (this.preopenSignIn !== null) {\n        clerkjs.openSignIn(this.preopenSignIn);\n      }\n\n      if (this.preopenSignUp !== null) {\n        clerkjs.openSignUp(this.preopenSignUp);\n      }\n\n      this.premountSignInNodes.forEach((props, node) => {\n        clerkjs.mountSignIn(node, props);\n      });\n      this.premountSignUpNodes.forEach((props, node) => {\n        clerkjs.mountSignUp(node, props);\n      });\n      this.premountUserProfileNodes.forEach((props, node) => {\n        clerkjs.mountUserProfile(node, props);\n      });\n      this.premountUserButtonNodes.forEach((props, node) => {\n        clerkjs.mountUserButton(node, props);\n      });\n      this._loaded = true;\n      return this.clerkjs;\n    };\n\n    this.setSession = (session, beforeEmit) => {\n      if (this.clerkjs) {\n        return this.clerkjs.setSession(session, beforeEmit);\n      } else {\n        return Promise.reject();\n      }\n    };\n\n    this.openSignIn = props => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.openSignIn(props);\n      } else {\n        this.preopenSignIn = props;\n      }\n    };\n\n    this.closeSignIn = () => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.closeSignIn();\n      } else {\n        this.preopenSignIn = null;\n      }\n    };\n\n    this.openSignUp = props => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.openSignUp(props);\n      } else {\n        this.preopenSignUp = props;\n      }\n    };\n\n    this.closeSignUp = () => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.closeSignUp();\n      } else {\n        this.preopenSignUp = null;\n      }\n    };\n\n    this.mountSignIn = (node, props) => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.mountSignIn(node, props);\n      } else {\n        this.premountSignInNodes.set(node, props);\n      }\n    };\n\n    this.unmountSignIn = node => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.unmountSignIn(node);\n      } else {\n        this.premountSignInNodes.delete(node);\n      }\n    };\n\n    this.mountSignUp = (node, props) => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.mountSignUp(node, props);\n      } else {\n        this.premountSignUpNodes.set(node, props);\n      }\n    };\n\n    this.unmountSignUp = node => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.unmountSignUp(node);\n      } else {\n        this.premountSignUpNodes.delete(node);\n      }\n    };\n\n    this.mountUserProfile = (node, props) => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.mountUserProfile(node, props);\n      } else {\n        this.premountUserProfileNodes.set(node, props);\n      }\n    };\n\n    this.unmountUserProfile = node => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.unmountUserProfile(node);\n      } else {\n        this.premountUserProfileNodes.delete(node);\n      }\n    };\n\n    this.mountUserButton = (node, userButtonProps) => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.mountUserButton(node, userButtonProps);\n      } else {\n        this.premountUserButtonNodes.set(node, userButtonProps);\n      }\n    };\n\n    this.unmountUserButton = node => {\n      if (this.clerkjs && this._loaded) {\n        this.clerkjs.unmountUserButton(node);\n      } else {\n        this.premountUserButtonNodes.delete(node);\n      }\n    };\n\n    this.addListener = listener => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.addListener(listener);\n      };\n\n      if (this.clerkjs) {\n        callback();\n      } else {\n        this.premountMethodCalls.set('addListener', callback);\n      }\n    };\n\n    this.loadFromServer = token => {\n      if (this.mode === 'browser') {\n        void this.throwError('loadFromServer cannot be called in a browser context.');\n      }\n\n      this.ssrData = JSON.stringify({\n        client: this.client,\n        session: this.session,\n        token: token\n      });\n    };\n\n    this.navigate = to => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.navigate(to);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        void callback();\n      } else {\n        this.premountMethodCalls.set('navigate', callback);\n      }\n    }; // DX: deprecated <=2.4.2\n    // Deprecate the boolean type before removing returnBack\n\n\n    this.redirectToSignIn = opts => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.redirectToSignIn(opts);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        void callback();\n      } else {\n        this.premountMethodCalls.set('redirectToSignIn', callback);\n      }\n    }; // DX: deprecated <=2.4.2\n    // Deprecate the boolean type before removing returnBack\n\n\n    this.redirectToSignUp = opts => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.redirectToSignUp(opts);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        void callback();\n      } else {\n        this.premountMethodCalls.set('redirectToSignUp', callback);\n      }\n    };\n\n    this.redirectToUserProfile = () => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.redirectToUserProfile();\n      };\n\n      if (this.clerkjs && this._loaded) {\n        callback();\n      } else {\n        this.premountMethodCalls.set('redirectToUserProfile', callback);\n      }\n    };\n\n    this.handleRedirectCallback = params => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.handleRedirectCallback(params);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        void callback();\n      } else {\n        this.premountMethodCalls.set('handleRedirectCallback', callback);\n      }\n    };\n\n    this.handleMagicLinkVerification = async params => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.handleMagicLinkVerification(params);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        return callback();\n      } else {\n        this.premountMethodCalls.set('handleMagicLinkVerification', callback);\n      }\n    };\n\n    this.authenticateWithMetamask = async params => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.authenticateWithMetamask(params);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        return callback();\n      } else {\n        this.premountMethodCalls.set('authenticateWithMetamask', callback);\n      }\n    };\n\n    this.signOut = async signOutCallback => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.signOut(signOutCallback);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        return callback();\n      } else {\n        this.premountMethodCalls.set('signOut', callback);\n      }\n    };\n\n    this.signOutOne = async signOutCallback => {\n      const callback = () => {\n        var _a;\n\n        return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.signOutOne(signOutCallback);\n      };\n\n      if (this.clerkjs && this._loaded) {\n        return callback();\n      } else {\n        this.premountMethodCalls.set('signOutOne', callback);\n      }\n    };\n\n    this.frontendApi = frontendApi;\n    this.options = options;\n    this.Clerk = Clerk;\n    this.mode = (0, utils_1.inBrowser)() ? 'browser' : 'server'; // TODO: Support SRR for NextJS\n    // const ssrDataNode = document.querySelector(`script[data-clerk=\"SSR\"]`);\n    // if (ssrDataNode) {\n    //   this.ssrData = ssrDataNode.innerHTML;\n    //   const parsedData = JSON.parse(this.ssrData);\n    //   this.ssrClient = parsedData.client;\n    //   this.ssrSession = parsedData.session;\n    // }\n  }\n\n  async loadClerkJS() {\n    if (!this.frontendApi) {\n      this.throwError(errors_1.noFrontendApiError);\n    }\n\n    try {\n      if (this.Clerk) {\n        // Set a fixed Clerk version\n        let c;\n\n        if ((0, utils_1.isConstructor)(this.Clerk)) {\n          // Construct a new Clerk object if a constructor is passed\n          c = new this.Clerk(this.frontendApi);\n          await c.load(this.options);\n        } else {\n          // Otherwise use the instantiated Clerk object\n          c = this.Clerk;\n\n          if (!c.isReady()) {\n            await c.load(this.options);\n          }\n        }\n\n        global.Clerk = c;\n      } else {\n        // Hot-load latest ClerkJS from Clerk CDN\n        await (0, utils_1.loadScript)(this.frontendApi, this.options.scriptUrl);\n\n        if (!global.Clerk) {\n          throw new Error('Failed to download latest ClerkJS. Contact support@clerk.dev.');\n        }\n\n        await global.Clerk.load(this.options);\n      }\n\n      return this.hydrateClerkJS(global.Clerk);\n    } catch (err) {\n      let message;\n\n      if (err instanceof Error) {\n        message = err.message;\n      } else {\n        message = String(err);\n      }\n\n      this.throwError(message);\n      return;\n    }\n  } // Custom wrapper to throw an error, since we need to apply different handling between\n  // production and development builds. In Next.js we can throw a full screen error in\n  // development mode. However, in production throwing an error results in an infinite loop\n  // as shown at https://github.com/vercel/next.js/issues/6973\n\n\n  throwError(errorMsg) {\n    if (process.env.NODE_ENV === 'production') {\n      console.error(errorMsg);\n    }\n\n    throw new Error(errorMsg);\n  }\n\n  get version() {\n    var _a;\n\n    return (_a = this.clerkjs) === null || _a === void 0 ? void 0 : _a.version;\n  }\n\n  get client() {\n    if (this.clerkjs) {\n      return this.clerkjs.client; // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n  get session() {\n    if (this.clerkjs) {\n      return this.clerkjs.session; // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n  get user() {\n    if (this.clerkjs) {\n      return this.clerkjs.user; // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  } // TODO: Remove temp use of __unstable__environment\n\n\n  get __unstable__environment() {\n    if (this.clerkjs) {\n      return this.clerkjs.__unstable__environment; // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n}\n\nexports.default = IsomorphicClerk;","map":{"version":3,"mappings":"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","names":["IsomorphicClerk","constructor","frontendApi","options","Clerk","Map","clerkjs","Error","premountMethodCalls","forEach","cb","preopenSignIn","openSignIn","preopenSignUp","openSignUp","premountSignInNodes","props","node","mountSignIn","premountSignUpNodes","mountSignUp","premountUserProfileNodes","mountUserProfile","premountUserButtonNodes","mountUserButton","_loaded","session","beforeEmit","setSession","Promise","reject","closeSignIn","closeSignUp","set","unmountSignIn","delete","unmountSignUp","unmountUserProfile","userButtonProps","unmountUserButton","listener","callback","_a","addListener","token","mode","throwError","ssrData","JSON","stringify","client","to","navigate","opts","redirectToSignIn","redirectToSignUp","redirectToUserProfile","params","handleRedirectCallback","handleMagicLinkVerification","authenticateWithMetamask","signOutCallback","signOut","signOutOne","loadClerkJS","errors_1","c","load","isReady","global","scriptUrl","hydrateClerkJS","err","message","String","errorMsg","process","env","NODE_ENV","console","error","version","undefined","user","__unstable__environment","exports"],"sources":["/Users/johnkeane/keanelabs/shopping-list/client/node_modules/@clerk/clerk-react/src/isomorphicClerk.ts"],"sourcesContent":["import type {\n  ActiveSessionResource,\n  AuthenticateWithMetamaskParams,\n  ClientResource,\n  HandleMagicLinkVerificationParams,\n  HandleOAuthCallbackParams,\n  RedirectOptions,\n  Resources,\n  SessionResource,\n  SignInProps,\n  SignOutCallback,\n  SignUpProps,\n  UserButtonProps,\n  UserProfileProps,\n  UserResource,\n} from '@clerk/types';\n\nimport { noFrontendApiError } from './errors';\nimport type {\n  BrowserClerk,\n  BrowserClerkConstructor,\n  ClerkProp,\n  IsomorphicClerkOptions,\n} from './types';\nimport { inBrowser, isConstructor, loadScript } from './utils';\n\nexport interface Global {\n  Clerk?: BrowserClerk;\n}\n\ndeclare const global: Global;\n\ntype MethodName<T> = {\n  [P in keyof T]: T[P] extends Function ? P : never;\n}[keyof T];\ntype MethodCallback = () => void;\n\nexport default class IsomorphicClerk {\n  private mode: string;\n  private frontendApi: string;\n  private options: IsomorphicClerkOptions;\n  private Clerk: ClerkProp;\n  private clerkjs: BrowserClerk | null = null;\n  private preopenSignIn?: null | SignInProps = null;\n  private preopenSignUp?: null | SignUpProps = null;\n  private premountSignInNodes = new Map<HTMLDivElement, SignInProps>();\n  private premountSignUpNodes = new Map<HTMLDivElement, SignUpProps>();\n  private premountUserProfileNodes = new Map<\n    HTMLDivElement,\n    UserProfileProps\n  >();\n  private premountUserButtonNodes = new Map<HTMLDivElement, UserButtonProps>();\n  private premountMethodCalls = new Map<\n    MethodName<BrowserClerk>,\n    MethodCallback\n  >();\n\n  private _loaded = false;\n\n  ssrData: string | null = null;\n  ssrClient?: ClientResource;\n  ssrSession?: SessionResource | null;\n\n  constructor(\n    frontendApi: string,\n    options: IsomorphicClerkOptions = {},\n    Clerk: ClerkProp = null,\n  ) {\n    this.frontendApi = frontendApi;\n    this.options = options;\n    this.Clerk = Clerk;\n\n    this.mode = inBrowser() ? 'browser' : 'server';\n\n    // TODO: Support SRR for NextJS\n    // const ssrDataNode = document.querySelector(`script[data-clerk=\"SSR\"]`);\n    // if (ssrDataNode) {\n    //   this.ssrData = ssrDataNode.innerHTML;\n    //   const parsedData = JSON.parse(this.ssrData);\n    //   this.ssrClient = parsedData.client;\n    //   this.ssrSession = parsedData.session;\n    // }\n  }\n\n  async loadClerkJS(): Promise<BrowserClerk | undefined> {\n    if (!this.frontendApi) {\n      this.throwError(noFrontendApiError);\n    }\n\n    try {\n      if (this.Clerk) {\n        // Set a fixed Clerk version\n        let c;\n\n        if (isConstructor<BrowserClerkConstructor>(this.Clerk)) {\n          // Construct a new Clerk object if a constructor is passed\n          c = new this.Clerk(this.frontendApi);\n          await c.load(this.options);\n        } else {\n          // Otherwise use the instantiated Clerk object\n          c = this.Clerk;\n\n          if (!c.isReady()) {\n            await c.load(this.options);\n          }\n        }\n\n        global.Clerk = c;\n      } else {\n        // Hot-load latest ClerkJS from Clerk CDN\n        await loadScript(this.frontendApi, this.options.scriptUrl);\n\n        if (!global.Clerk) {\n          throw new Error(\n            'Failed to download latest ClerkJS. Contact support@clerk.dev.',\n          );\n        }\n\n        await global.Clerk.load(this.options);\n      }\n\n      return this.hydrateClerkJS(global.Clerk);\n    } catch (err) {\n      let message;\n\n      if (err instanceof Error) {\n        message = err.message;\n      } else {\n        message = String(err);\n      }\n\n      this.throwError(message);\n\n      return;\n    }\n  }\n\n  // Custom wrapper to throw an error, since we need to apply different handling between\n  // production and development builds. In Next.js we can throw a full screen error in\n  // development mode. However, in production throwing an error results in an infinite loop\n  // as shown at https://github.com/vercel/next.js/issues/6973\n  throwError(errorMsg: string): void {\n    if (process.env.NODE_ENV === 'production') {\n      console.error(errorMsg);\n    }\n    throw new Error(errorMsg);\n  }\n\n  private hydrateClerkJS = async (clerkjs: BrowserClerk | undefined) => {\n    if (!clerkjs) {\n      throw new Error('Failed to hydrate latest Clerk JS');\n    }\n\n    this.clerkjs = clerkjs;\n\n    this.premountMethodCalls.forEach(cb => cb());\n\n    if (this.preopenSignIn !== null) {\n      clerkjs.openSignIn(this.preopenSignIn);\n    }\n\n    if (this.preopenSignUp !== null) {\n      clerkjs.openSignUp(this.preopenSignUp);\n    }\n\n    this.premountSignInNodes.forEach(\n      (props: SignInProps, node: HTMLDivElement) => {\n        clerkjs.mountSignIn(node, props);\n      },\n    );\n\n    this.premountSignUpNodes.forEach(\n      (props: SignUpProps, node: HTMLDivElement) => {\n        clerkjs.mountSignUp(node, props);\n      },\n    );\n\n    this.premountUserProfileNodes.forEach(\n      (props: UserProfileProps, node: HTMLDivElement) => {\n        clerkjs.mountUserProfile(node, props);\n      },\n    );\n\n    this.premountUserButtonNodes.forEach(\n      (props: UserButtonProps, node: HTMLDivElement) => {\n        clerkjs.mountUserButton(node, props);\n      },\n    );\n\n    this._loaded = true;\n\n    return this.clerkjs;\n  };\n\n  get version(): string | undefined {\n    return this.clerkjs?.version;\n  }\n\n  get client(): ClientResource | undefined {\n    if (this.clerkjs) {\n      return this.clerkjs.client;\n      // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n  get session(): ActiveSessionResource | undefined | null {\n    if (this.clerkjs) {\n      return this.clerkjs.session;\n      // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n  get user(): UserResource | undefined | null {\n    if (this.clerkjs) {\n      return this.clerkjs.user;\n      // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n  // TODO: Remove temp use of __unstable__environment\n  get __unstable__environment(): any {\n    if (this.clerkjs) {\n      return (this.clerkjs as any).__unstable__environment;\n      // TODO: add ssr condition\n    } else {\n      return undefined;\n    }\n  }\n\n  setSession = (\n    session: ActiveSessionResource | string | null,\n    beforeEmit?: (session: ActiveSessionResource | null) => void | Promise<any>,\n  ): Promise<void> => {\n    if (this.clerkjs) {\n      return this.clerkjs.setSession(session, beforeEmit);\n    } else {\n      return Promise.reject();\n    }\n  };\n\n  openSignIn = (props?: SignInProps): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.openSignIn(props);\n    } else {\n      this.preopenSignIn = props;\n    }\n  };\n\n  closeSignIn = (): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.closeSignIn();\n    } else {\n      this.preopenSignIn = null;\n    }\n  };\n\n  openSignUp = (props?: SignUpProps): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.openSignUp(props);\n    } else {\n      this.preopenSignUp = props;\n    }\n  };\n\n  closeSignUp = (): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.closeSignUp();\n    } else {\n      this.preopenSignUp = null;\n    }\n  };\n\n  mountSignIn = (node: HTMLDivElement, props: SignInProps): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.mountSignIn(node, props);\n    } else {\n      this.premountSignInNodes.set(node, props);\n    }\n  };\n\n  unmountSignIn = (node: HTMLDivElement): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.unmountSignIn(node);\n    } else {\n      this.premountSignInNodes.delete(node);\n    }\n  };\n\n  mountSignUp = (node: HTMLDivElement, props: SignUpProps): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.mountSignUp(node, props);\n    } else {\n      this.premountSignUpNodes.set(node, props);\n    }\n  };\n\n  unmountSignUp = (node: HTMLDivElement): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.unmountSignUp(node);\n    } else {\n      this.premountSignUpNodes.delete(node);\n    }\n  };\n\n  mountUserProfile = (node: HTMLDivElement, props: UserProfileProps): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.mountUserProfile(node, props);\n    } else {\n      this.premountUserProfileNodes.set(node, props);\n    }\n  };\n\n  unmountUserProfile = (node: HTMLDivElement): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.unmountUserProfile(node);\n    } else {\n      this.premountUserProfileNodes.delete(node);\n    }\n  };\n\n  mountUserButton = (\n    node: HTMLDivElement,\n    userButtonProps: UserButtonProps,\n  ): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.mountUserButton(node, userButtonProps);\n    } else {\n      this.premountUserButtonNodes.set(node, userButtonProps);\n    }\n  };\n\n  unmountUserButton = (node: HTMLDivElement): void => {\n    if (this.clerkjs && this._loaded) {\n      this.clerkjs.unmountUserButton(node);\n    } else {\n      this.premountUserButtonNodes.delete(node);\n    }\n  };\n\n  addListener = (listener: (emission: Resources) => void): void => {\n    const callback = () => this.clerkjs?.addListener(listener);\n    if (this.clerkjs) {\n      callback();\n    } else {\n      this.premountMethodCalls.set('addListener', callback);\n    }\n  };\n\n  loadFromServer = (token: string): void => {\n    if (this.mode === 'browser') {\n      void this.throwError(\n        'loadFromServer cannot be called in a browser context.',\n      );\n    }\n\n    this.ssrData = JSON.stringify({\n      client: this.client,\n      session: this.session,\n      token: token,\n    });\n  };\n\n  navigate = (to: string): void => {\n    const callback = () => this.clerkjs?.navigate(to);\n    if (this.clerkjs && this._loaded) {\n      void callback();\n    } else {\n      this.premountMethodCalls.set('navigate', callback);\n    }\n  };\n\n  // DX: deprecated <=2.4.2\n  // Deprecate the boolean type before removing returnBack\n  redirectToSignIn = (opts: RedirectOptions | boolean): void => {\n    const callback = () => this.clerkjs?.redirectToSignIn(opts as any);\n    if (this.clerkjs && this._loaded) {\n      void callback();\n    } else {\n      this.premountMethodCalls.set('redirectToSignIn', callback);\n    }\n  };\n\n  // DX: deprecated <=2.4.2\n  // Deprecate the boolean type before removing returnBack\n  redirectToSignUp = (opts: RedirectOptions | boolean): void => {\n    const callback = () => this.clerkjs?.redirectToSignUp(opts as any);\n    if (this.clerkjs && this._loaded) {\n      void callback();\n    } else {\n      this.premountMethodCalls.set('redirectToSignUp', callback);\n    }\n  };\n\n  redirectToUserProfile = (): void => {\n    const callback = () => this.clerkjs?.redirectToUserProfile();\n    if (this.clerkjs && this._loaded) {\n      callback();\n    } else {\n      this.premountMethodCalls.set('redirectToUserProfile', callback);\n    }\n  };\n\n  handleRedirectCallback = (params: HandleOAuthCallbackParams): void => {\n    const callback = () => this.clerkjs?.handleRedirectCallback(params);\n    if (this.clerkjs && this._loaded) {\n      void callback();\n    } else {\n      this.premountMethodCalls.set('handleRedirectCallback', callback);\n    }\n  };\n\n  handleMagicLinkVerification = async (\n    params: HandleMagicLinkVerificationParams,\n  ): Promise<void> => {\n    const callback = () => this.clerkjs?.handleMagicLinkVerification(params);\n    if (this.clerkjs && this._loaded) {\n      return callback() as Promise<void>;\n    } else {\n      this.premountMethodCalls.set('handleMagicLinkVerification', callback);\n    }\n  };\n\n  authenticateWithMetamask = async (\n    params: AuthenticateWithMetamaskParams,\n  ): Promise<void> => {\n    const callback = () => this.clerkjs?.authenticateWithMetamask(params);\n    if (this.clerkjs && this._loaded) {\n      return callback() as Promise<void>;\n    } else {\n      this.premountMethodCalls.set('authenticateWithMetamask', callback);\n    }\n  };\n\n  signOut = async (signOutCallback?: SignOutCallback): Promise<void> => {\n    const callback = () => this.clerkjs?.signOut(signOutCallback);\n    if (this.clerkjs && this._loaded) {\n      return callback() as Promise<void>;\n    } else {\n      this.premountMethodCalls.set('signOut', callback);\n    }\n  };\n\n  signOutOne = async (signOutCallback?: SignOutCallback): Promise<void> => {\n    const callback = () => this.clerkjs?.signOutOne(signOutCallback);\n    if (this.clerkjs && this._loaded) {\n      return callback() as Promise<void>;\n    } else {\n      this.premountMethodCalls.set('signOutOne', callback);\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"script"}